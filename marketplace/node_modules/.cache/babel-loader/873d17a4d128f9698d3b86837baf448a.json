{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Venta_GPU\\\\marketplace\\\\src\\\\components\\\\Main.js\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport Marketplace from '../abis/Marketplace.json';\nimport './style.css';\n\nvar Main = /*#__PURE__*/function (_Component) {\n  _inherits(Main, _Component);\n\n  function Main() {\n    var _this;\n\n    _classCallCheck(this, Main);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Main).call(this));\n    _this.state = {\n      account: '',\n      productCount: 0,\n      productos: [],\n      loading: true\n    };\n    _this.crearProduct = _this.crearProduct.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.comprarProduct = _this.comprarProduct.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Main, [{\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                window.addEventListener('load', /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          if (!window.ethereum) {\n                            _context.next = 6;\n                            break;\n                          }\n\n                          window.web3 = new Web3(window.ethereum);\n                          _context.next = 4;\n                          return window.ethereum.enable();\n\n                        case 4:\n                          _context.next = 7;\n                          break;\n\n                        case 6:\n                          if (window.web3) {\n                            window.web3 = new Web3(window.web3.currentProvider);\n                          } else {\n                            window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n                          }\n\n                        case 7:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                })));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n\n      return loadWeb3;\n    }()\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var web3, accounts, networkID, networkData, marketplace, productCount, i, product;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                web3 = new Web3(window.web3.currentProvider);\n                _context3.next = 3;\n                return web3.eth.getAccounts();\n\n              case 3:\n                accounts = _context3.sent;\n                this.setState({\n                  account: accounts[0]\n                });\n                _context3.next = 7;\n                return web3.eth.net.getId();\n\n              case 7:\n                networkID = _context3.sent;\n                networkData = Marketplace.networks[networkID];\n\n                if (!networkData) {\n                  _context3.next = 28;\n                  break;\n                }\n\n                marketplace = new web3.eth.Contract(Marketplace.abi, networkData.address);\n                this.setState({\n                  marketplace: marketplace\n                });\n                _context3.next = 14;\n                return marketplace.methods.productCount().call();\n\n              case 14:\n                productCount = _context3.sent;\n                this.setState({\n                  productCount: productCount\n                }); //cargar los productos\n\n                i = 1;\n\n              case 17:\n                if (!(i <= productCount)) {\n                  _context3.next = 25;\n                  break;\n                }\n\n                _context3.next = 20;\n                return marketplace.methods.productos(i).call();\n\n              case 20:\n                product = _context3.sent;\n                this.setState({\n                  productos: [].concat(_toConsumableArray(this.state.productos), [product])\n                });\n\n              case 22:\n                i++;\n                _context3.next = 17;\n                break;\n\n              case 25:\n                this.setState({\n                  loading: false\n                });\n                _context3.next = 29;\n                break;\n\n              case 28:\n                window.alert('Contrato de Marketplace no fue reconocido en la RED');\n\n              case 29:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n\n      return loadBlockchainData;\n    }()\n  }, {\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.loadWeb3();\n\n              case 2:\n                _context4.next = 4;\n                return this.loadBlockchainData();\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: \"crearProduct\",\n    value: function crearProduct(Nombre, Modelo, Cantidad, price) {\n      var _this2 = this;\n\n      this.setState({\n        loading: true\n      });\n      this.state.marketplace.methods.crearProduct(Nombre, Modelo, Cantidad, price).send({\n        from: this.state.account\n      }).once('receipt', function (receipt) {\n        _this2.setState({\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"comprarProduct\",\n    value: function comprarProduct(id, precio) {\n      var _this3 = this;\n\n      this.setState({\n        loading: true\n      });\n      this.state.marketplace.methods.comprarProduct(id).send({\n        from: this.state.account,\n        value: precio\n      }).once('receipt', function (receipt) {\n        _this3.setState({\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return React.createElement(\"div\", {\n        id: \"contenido\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, \"Comprar Producto\"), React.createElement(\"table\", {\n        className: \"table\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, \"#\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, \"Nombre\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, \"Modelo\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, \"Cantidad\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, \"Precio\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, \"Due\\xF1o\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }))), React.createElement(\"tbody\", {\n        id: \"productList\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, this.state.productos.map(function (producto, key) {\n        return React.createElement(\"tr\", {\n          className: \"rowData\",\n          key: key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          scope: \"row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93\n          },\n          __self: this\n        }, producto.Id.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        }, producto.Nombre.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        }, producto.Modelo.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, producto.Cantidad.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, window.web3.utils.fromWei(producto.price.toString(), 'Ether'), \" ETH\"), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, producto.Owner), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99\n          },\n          __self: this\n        }, !producto.comprado ? React.createElement(\"button\", {\n          name: producto.Id,\n          value: producto.price,\n          onClick: function onClick(event) {\n            _this4.comprarProduct(event.target.name, event.target.value);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, \"Comprar\") : null));\n      }))));\n    }\n  }]);\n\n  return Main;\n}(Component);\n\nexport default Main;","map":{"version":3,"sources":["C:/Users/Rasb-/Documents/Unitec/Vanguardia/Proyecto/Venta_GPU/marketplace/src/components/Main.js"],"names":["React","Component","Web3","Marketplace","Main","state","account","productCount","productos","loading","crearProduct","bind","comprarProduct","window","addEventListener","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","setState","net","getId","networkID","networkData","networks","marketplace","Contract","abi","address","methods","call","i","product","loadWeb3","loadBlockchainData","Nombre","Modelo","Cantidad","price","send","from","once","receipt","id","precio","value","map","producto","key","Id","toString","utils","fromWei","Owner","comprado","event","target","name"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Web3 from 'web3'\r\nimport Marketplace from '../abis/Marketplace.json'\r\nimport './style.css'\r\nclass Main extends Component {\r\n    constructor() {\r\n        super()\r\n        this.state = {\r\n            account: '',\r\n            productCount: 0,\r\n            productos: [],\r\n            loading: true\r\n        }\r\n        this.crearProduct = this.crearProduct.bind(this)\r\n        this.comprarProduct = this.comprarProduct.bind(this)\r\n    }\r\n    async loadWeb3() {\r\n        window.addEventListener('load', async () => {\r\n            if (window.ethereum) {\r\n                window.web3 = new Web3(window.ethereum)\r\n                await window.ethereum.enable()\r\n            }\r\n            else if (window.web3) {\r\n                window.web3 = new Web3(window.web3.currentProvider)\r\n            }\r\n            else {\r\n                window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\r\n            }\r\n        });\r\n    }\r\n    async loadBlockchainData() {\r\n        const web3 = new Web3(window.web3.currentProvider)\r\n        const accounts = await web3.eth.getAccounts()\r\n        this.setState({ account: accounts[0] })\r\n        const networkID = await web3.eth.net.getId()\r\n        const networkData = Marketplace.networks[networkID]\r\n        if (networkData) {\r\n            const marketplace = new web3.eth.Contract(Marketplace.abi, networkData.address)\r\n            this.setState({ marketplace })\r\n            const productCount = await marketplace.methods.productCount().call()\r\n            this.setState({ productCount })\r\n            //cargar los productos\r\n            for (var i = 1; i <= productCount; i++) {\r\n                const product = await marketplace.methods.productos(i).call()\r\n                this.setState({\r\n                    productos: [...this.state.productos, product]\r\n                })\r\n            }\r\n            this.setState({ loading: false })\r\n        } else {\r\n            window.alert('Contrato de Marketplace no fue reconocido en la RED')\r\n        }\r\n    }\r\n    async componentWillMount() {\r\n        await this.loadWeb3()\r\n        await this.loadBlockchainData()\r\n    }\r\n    crearProduct(Nombre, Modelo, Cantidad, price) {\r\n        this.setState({ loading: true })\r\n        this.state.marketplace.methods.crearProduct(Nombre, Modelo, Cantidad, price).send({ from: this.state.account })\r\n            .once('receipt', (receipt) => {\r\n                this.setState({ loading: false })\r\n            })\r\n    }\r\n    comprarProduct(id, precio) {\r\n        this.setState({ loading: true })\r\n        this.state.marketplace.methods.comprarProduct(id).send({ from: this.state.account, value: precio })\r\n            .once('receipt', (receipt) => {\r\n                this.setState({ loading: false })\r\n            })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div id=\"contenido\">\r\n                <h2>Comprar Producto</h2>\r\n                <table className=\"table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th scope=\"col\">#</th>\r\n                            <th scope=\"col\">Nombre</th>\r\n                            <th scope=\"col\">Modelo</th>\r\n                            <th scope=\"col\">Cantidad</th>\r\n                            <th scope=\"col\">Precio</th>\r\n                            <th scope=\"col\">Due√±o</th>\r\n                            <th scope=\"col\"></th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody id=\"productList\">\r\n                        {this.state.productos.map((producto, key) => {\r\n                            return (\r\n                                <tr className=\"rowData\" key={key}>\r\n                                    <th scope=\"row\">{producto.Id.toString()}</th>\r\n                                    <td>{producto.Nombre.toString()}</td>\r\n                                    <td>{producto.Modelo.toString()}</td>\r\n                                    <td>{producto.Cantidad.toString()}</td>\r\n                                    <td>{window.web3.utils.fromWei(producto.price.toString(), 'Ether')} ETH</td>\r\n                                    <td>{producto.Owner}</td>\r\n                                    <td>{!producto.comprado\r\n                                        ? <button\r\n                                            name={producto.Id}\r\n                                            value={producto.price}\r\n                                            onClick={(event) => {\r\n                                                this.comprarProduct(event.target.name, event.target.value)\r\n                                            }}>\r\n                                            Comprar\r\n                                        </button>\r\n                                        : null}\r\n                                    </td>\r\n                                </tr>\r\n                            )\r\n                        })}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Main;"]},"metadata":{},"sourceType":"module"}