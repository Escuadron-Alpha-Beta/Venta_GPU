{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _createClass from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Rasb-\\\\Documents\\\\Unitec\\\\Vanguardia\\\\Proyecto\\\\Viejo\\\\Venta_GPU\\\\marketplace\\\\src\\\\components\\\\Venta.js\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport Marketplace from '../abis/Marketplace.json';\nimport './style.css';\n\nvar Venta = /*#__PURE__*/function (_Component) {\n  _inherits(Venta, _Component);\n\n  _createClass(Venta, [{\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                window.addEventListener('load', /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          if (!window.ethereum) {\n                            _context.next = 6;\n                            break;\n                          }\n\n                          window.web3 = new Web3(window.ethereum);\n                          _context.next = 4;\n                          return window.ethereum.enable();\n\n                        case 4:\n                          _context.next = 7;\n                          break;\n\n                        case 6:\n                          if (window.web3) {\n                            window.web3 = new Web3(window.web3.currentProvider);\n                          } else {\n                            window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n                          }\n\n                        case 7:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                })));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n\n      return loadWeb3;\n    }()\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var web3, accounts, networkID, networkData, marketplace, productCount, i, product;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                web3 = new Web3(window.web3.currentProvider);\n                _context3.next = 3;\n                return web3.eth.getAccounts();\n\n              case 3:\n                accounts = _context3.sent;\n                this.setState({\n                  account: accounts[0]\n                });\n                _context3.next = 7;\n                return web3.eth.net.getId();\n\n              case 7:\n                networkID = _context3.sent;\n                networkData = Marketplace.networks[networkID];\n\n                if (!networkData) {\n                  _context3.next = 28;\n                  break;\n                }\n\n                marketplace = new web3.eth.Contract(Marketplace.abi, networkData.address);\n                this.setState({\n                  marketplace: marketplace\n                });\n                _context3.next = 14;\n                return marketplace.methods.productCount().call();\n\n              case 14:\n                productCount = _context3.sent;\n                this.setState({\n                  productCount: productCount\n                }); //cargar los productos\n\n                i = 1;\n\n              case 17:\n                if (!(i <= productCount)) {\n                  _context3.next = 25;\n                  break;\n                }\n\n                _context3.next = 20;\n                return marketplace.methods.productos(i).call();\n\n              case 20:\n                product = _context3.sent;\n                this.setState({\n                  productos: [].concat(_toConsumableArray(this.state.productos), [product])\n                });\n\n              case 22:\n                i++;\n                _context3.next = 17;\n                break;\n\n              case 25:\n                this.setState({\n                  loading: false\n                });\n                _context3.next = 29;\n                break;\n\n              case 28:\n                window.alert('Contrato de Marketplace no fue reconocido en la RED');\n\n              case 29:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n\n      return loadBlockchainData;\n    }()\n  }]);\n\n  function Venta(props) {\n    var _this;\n\n    _classCallCheck(this, Venta);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Venta).call(this, props));\n    _this.state = {\n      account: '',\n      productCount: 0,\n      productos: [],\n      loading: true\n    };\n    _this.crearProduct = _this.crearProduct.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.comprarProduct = _this.comprarProduct.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Venta, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.loadWeb3();\n\n              case 2:\n                _context4.next = 4;\n                return this.loadBlockchainData();\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: \"crearProduct\",\n    value: function crearProduct(Nombre, Modelo, Cantidad, price) {\n      var _this2 = this;\n\n      this.setState({\n        loading: true\n      });\n      this.state.marketplace.methods.crearProduct(Nombre, Modelo, Cantidad, price).send({\n        from: this.state.account\n      }).once('receipt', function (receipt) {\n        _this2.setState({\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"comprarProduct\",\n    value: function comprarProduct(id, precio) {\n      var _this3 = this;\n\n      this.setState({\n        loading: true\n      });\n      this.state.marketplace.methods.comprarProduct(id).send({\n        from: this.state.account,\n        value: precio\n      }).once('receipt', function (receipt) {\n        _this3.setState({\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return React.createElement(\"div\", {\n        id: \"contenido\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, \"A\\xF1adir Producto\"), React.createElement(\"form\", {\n        onSubmit: function onSubmit(event) {\n          event.preventDefault();\n          var name = _this4.productName.value;\n          var modelo = _this4.productModelo.value;\n          var cantidad = _this4.productCantidad.value;\n          var price = window.web3.utils.toWei(_this4.productPrice.value.toString(), 'Ether');\n\n          _this4.props.crearProduct(name, modelo, cantidad, price);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group mr-sm-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"productName\",\n        type: \"text\",\n        ref: function ref(input) {\n          _this4.productName = input;\n        },\n        className: \"form-control\",\n        placeholder: \"Product Name\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group mr-sm-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"productModelo\",\n        type: \"text\",\n        ref: function ref(input) {\n          _this4.productModelo = input;\n        },\n        className: \"form-control\",\n        placeholder: \"Product Modelo\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group mr-sm-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"productCantidad\",\n        type: \"text\",\n        ref: function ref(input) {\n          _this4.productCantidad = input;\n        },\n        className: \"form-control\",\n        placeholder: \"Product Cantidad\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group mr-sm-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"productPrice\",\n        type: \"text\",\n        ref: function ref(input) {\n          _this4.productPrice = input;\n        },\n        className: \"form-control\",\n        placeholder: \"Product Price\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, \"A\\xF1adir Producto\")), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, \" \"), React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, \"Comprar producto\"), React.createElement(\"table\", {\n        className: \"table\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, \"#\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, \"Nombre\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, \"Modelo\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, \"Cantidad\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, \"Precio\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, \"Due\\xF1o\"))), React.createElement(\"tbody\", {\n        id: \"productos\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, this.props.productos.map(function (producto, key) {\n        return React.createElement(\"tr\", {\n          key: key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          scope: \"row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }, producto.Id.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }, producto.Nombre.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }, producto.Modelo.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, producto.Cantidad.toString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, window.web3.utils.fromWei(producto.price.toString(), 'Ether'), \" ETH\"), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        }, producto.Owner), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, !producto.comprado ? React.createElement(\"button\", {\n          name: producto.Id,\n          value: producto.price,\n          onClick: function onClick(event) {\n            _this4.props.comprarProduct(event.target.name, event.target.value);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, \"Comprar\") : null));\n      }))));\n    }\n  }]);\n\n  return Venta;\n}(Component);\n\nexport default Venta;","map":{"version":3,"sources":["C:/Users/Rasb-/Documents/Unitec/Vanguardia/Proyecto/Viejo/Venta_GPU/marketplace/src/components/Venta.js"],"names":["React","Component","Web3","Marketplace","Venta","window","addEventListener","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","setState","account","net","getId","networkID","networkData","networks","marketplace","Contract","abi","address","methods","productCount","call","i","productos","product","state","loading","props","crearProduct","bind","comprarProduct","loadWeb3","loadBlockchainData","Nombre","Modelo","Cantidad","price","send","from","once","receipt","id","precio","value","event","preventDefault","name","productName","modelo","productModelo","cantidad","productCantidad","utils","toWei","productPrice","toString","input","map","producto","key","Id","fromWei","Owner","comprado","target"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Web3 from 'web3'\r\nimport Marketplace from '../abis/Marketplace.json'\r\nimport './style.css';\r\nclass Venta extends Component {\r\n    \r\n    async loadWeb3() {\r\n        window.addEventListener('load', async () => {\r\n          if (window.ethereum) {\r\n            window.web3 = new Web3(window.ethereum)\r\n            await window.ethereum.enable()\r\n          }\r\n          else if (window.web3) {\r\n            window.web3 = new Web3(window.web3.currentProvider)\r\n          }\r\n          else {\r\n            window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\r\n          }\r\n        });\r\n      }\r\n      async loadBlockchainData() {\r\n        const web3 = new Web3(window.web3.currentProvider)\r\n        const accounts = await web3.eth.getAccounts()\r\n        this.setState({ account: accounts[0] })\r\n        const networkID = await web3.eth.net.getId()\r\n        const networkData = Marketplace.networks[networkID]\r\n        if (networkData) {\r\n          const marketplace = new web3.eth.Contract(Marketplace.abi, networkData.address)\r\n          this.setState({ marketplace })\r\n          const productCount = await marketplace.methods.productCount().call()\r\n          this.setState({productCount})\r\n          //cargar los productos\r\n          for (var i =1 ; i <= productCount ; i++){\r\n            const product = await marketplace.methods.productos(i).call()\r\n            this.setState({\r\n              productos :[...this.state.productos, product]\r\n            })\r\n          }\r\n          this.setState({ loading: false })\r\n          \r\n        } else {\r\n          window.alert('Contrato de Marketplace no fue reconocido en la RED')\r\n        }\r\n      }\r\n      constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n          account: '',\r\n          productCount: 0,\r\n          productos: [],\r\n          loading: true\r\n        }\r\n        this.crearProduct = this.crearProduct.bind(this)\r\n        this.comprarProduct = this.comprarProduct.bind(this)\r\n      }\r\n      async componentWillMount() {\r\n        await this.loadWeb3()\r\n        await this.loadBlockchainData()\r\n      }\r\n      crearProduct(Nombre, Modelo, Cantidad ,price){\r\n        this.setState({loading : true})\r\n        this.state.marketplace.methods.crearProduct(Nombre,Modelo, Cantidad ,price).send({from: this.state.account})\r\n        .once('receipt',(receipt) => {\r\n          this.setState({loading : false})\r\n        })\r\n      }\r\n      comprarProduct(id,precio){\r\n        this.setState({loading : true})\r\n        this.state.marketplace.methods.comprarProduct(id).send({ from: this.state.account, value: precio })\r\n        .once('receipt',(receipt) => {\r\n          this.setState({loading : false})\r\n        })\r\n      }\r\n\r\n    render() {\r\n        return (\r\n            <div id=\"contenido\">\r\n                <h1>Añadir Producto</h1>\r\n                <form onSubmit={(event) => {\r\n                    event.preventDefault()\r\n                    const name = this.productName.value\r\n                    const modelo = this.productModelo.value\r\n                    const cantidad = this.productCantidad.value\r\n                    const price = window.web3.utils.toWei(this.productPrice.value.toString(), 'Ether')\r\n                    this.props.crearProduct(name, modelo, cantidad, price)\r\n                }}>\r\n                    <div className=\"form-group mr-sm-2\">\r\n                        <input\r\n                            id=\"productName\"\r\n                            type=\"text\"\r\n                            ref={(input) => { this.productName = input }}\r\n                            className=\"form-control\"\r\n                            placeholder=\"Product Name\"\r\n                            required />\r\n                    </div>\r\n                    <div className=\"form-group mr-sm-2\">\r\n                        <input\r\n                            id=\"productModelo\"\r\n                            type=\"text\"\r\n                            ref={(input) => { this.productModelo = input }}\r\n                            className=\"form-control\"\r\n                            placeholder=\"Product Modelo\"\r\n                            required />\r\n                    </div>\r\n                    <div className=\"form-group mr-sm-2\">\r\n                        <input\r\n                            id=\"productCantidad\"\r\n                            type=\"text\"\r\n                            ref={(input) => { this.productCantidad = input }}\r\n                            className=\"form-control\"\r\n                            placeholder=\"Product Cantidad\"\r\n                            required />\r\n                    </div>\r\n                    <div className=\"form-group mr-sm-2\">\r\n                        <input\r\n                            id=\"productPrice\"\r\n                            type=\"text\"\r\n                            ref={(input) => { this.productPrice = input }}\r\n                            className=\"form-control\"\r\n                            placeholder=\"Product Price\"\r\n                            required />\r\n                    </div>\r\n                    <button type=\"submit\" className=\"btn btn-primary\">Añadir Producto</button>\r\n                </form>\r\n                <p> </p>\r\n                <h2>Comprar producto</h2>\r\n                <table className=\"table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th scope=\"col\">#</th>\r\n                            <th scope=\"col\">Nombre</th>\r\n                            <th scope=\"col\">Modelo</th>\r\n                            <th scope=\"col\">Cantidad</th>\r\n                            <th scope=\"col\">Precio</th>\r\n                            <th scope=\"col\">Dueño</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody id=\"productos\">\r\n                        {this.props.productos.map((producto, key) => {\r\n                            return (\r\n                                <tr key={key}>\r\n                                    <th scope=\"row\">{producto.Id.toString()}</th>\r\n                                    <td>{producto.Nombre.toString()}</td>\r\n                                    <td>{producto.Modelo.toString()}</td>\r\n                                    <td>{producto.Cantidad.toString()}</td>\r\n                                    <td>{window.web3.utils.fromWei(producto.price.toString(), 'Ether')} ETH</td>\r\n                                    <td>{producto.Owner}</td>\r\n                                    <td>{!producto.comprado\r\n                                        ? <button\r\n                                            name={producto.Id}\r\n                                            value={producto.price}\r\n                                            onClick={(event) => {\r\n                                                this.props.comprarProduct(event.target.name, event.target.value)\r\n                                            }}>\r\n                                            Comprar\r\n                                            </button>\r\n                                        : null}\r\n                                    </td>\r\n                                </tr>\r\n                            )\r\n                        })}\r\n\r\n\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default Venta;"]},"metadata":{},"sourceType":"module"}